MATCH(p:promotion) where p.p_channel_email='N' or p.p_channel_event='N' MATCH(p)<-[:ON_Promo]-(ss:store_sales) WITH ss MATCH(d:date_dim{d_year:1998}) WITH d, ss MATCH(d)<-[:ON_Date]-(ss) WITH ss, d MATCH(c:customer{cd_gender:'F', cd_marital_status:'W', cd_education_status:'2 yr Degree'}) WITH c,ss MATCH(c)<-[:BY_Customer]-(ss) with ss MATCH (ss)-[:OF_Item]->(i:item) with ss, i return i.i_item_id, Avg(ss.ss_quantity) as agg1, Avg(ss.ss_list_price) as agg2, Avg(ss.ss_coupon_amt) as agg3, avg(ss.ss_sales_price) as agg4 order by i.i_item_id limit 100;
