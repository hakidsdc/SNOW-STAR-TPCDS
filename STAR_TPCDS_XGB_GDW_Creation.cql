USING PERIODIC COMMIT LOAD CSV FROM 'file:///home/tpcds/star/star_data_5GB/customer1.csv' AS line FIELDTERMINATOR '|' CREATE (:customer { c_customer_sk: toInteger(line[0]),  c_customer_id  : line[1], c_salutation : line[2],  c_first_name: line[3], c_last_name  : toInteger(line[4]),  c_preferred_cust_flag : line[5], c_birth_day  : toInteger(line[6]), c_birth_month :  toInteger(line[7]),  c_birth_year:  toInteger(line[8]), c_birth_country :  line[9], c_login :  line[10],   c_email_address  :  line[11],  c_last_review_date :  line[12], hd_buy_potential : line[13], hd_dep_count : toInteger(line[14]), hd_vehicle_count  : toInteger(line[15]), ib_lower_bound  : toInteger(line[16]), ib_upper_bound: toInteger(line[17]), ca_address_id: line[18], ca_street_number: line[19], ca_street_name : line[20], ca_street_type: line[21], ca_suite_number: line[22],  ca_city : line[23], ca_county : line[24], ca_state : line[25], ca_zip : line[26], ca_country : line[27],  ca_gmt_offset: toFloat(line[28]),  ca_location_type: line[29], cd_gender : line[30], cd_marital_status: line[31], cd_education_status : line[32], cd_purchase_estimate: toInteger(line[33]), cd_credit_rating : line[34], cd_dep_count : toInteger(line[35]), cd_dep_employed_count : toInteger(line[36]), cd_dep_college_count : toInteger(line[37])});
USING PERIODIC COMMIT LOAD CSV FROM 'file:///home/tpcds/snow/snow_data_5GB/date_dim.csv' AS line FIELDTERMINATOR '|' CREATE (:date_dim { d_date_sk: toInteger(line[0]),  d_date_id  : line[1], d_date: date(line[2]), d_month_seq : toInteger(line[3]), d_week_seq : toInteger(line[4]), d_quarter_seq : toInteger(line[5]),  d_year : toInteger(line[6]), d_dow : toInteger(line[7]),  d_moy : toInteger(line[8]), d_dom : toInteger(line[9]), d_qoy : toInteger(line[10]), d_fy_year : toInteger(line[11]),  d_fy_quarter_seq :  toInteger(line[12]), d_fy_week_seq : toInteger(line[13]), d_day_name : line[14], d_quarter_name : line[15], d_holiday :  line[16], d_weekend:  line[17], d_following_holiday:  line[18], d_first_dom:  toInteger(line[19]),  d_last_dom:  toInteger(line[20]), d_same_day_ly:  toInteger(line[21]), d_same_day_lq : toInteger(line[22]), d_current_day: line[23], d_current_week : line[24], d_current_month :  line[25], d_current_quarter : line[26], d_current_year :  line[27]});
USING PERIODIC COMMIT LOAD CSV FROM 'file:///home/tpcds/snow/snow_data_5GB/time_dim1.csv' AS line FIELDTERMINATOR '|' CREATE (:time_dim {t_time_sk: toInteger(line[0]),   t_time_id  : line[1], t_time: toInteger(line[2]), t_hour : toInteger(line[3]),  t_minute : toInteger(line[4]), t_second  : toInteger(line[5]), t_am_pm : line[6], t_shift : line[7],  t_sub_shift : line[8], t_meal_time : line[9]});
USING PERIODIC COMMIT LOAD CSV FROM 'file:///home/tpcds/snow/snow_data_5GB/item1.csv' AS line FIELDTERMINATOR '|' CREATE (:item { i_item_sk: toInteger(line[0]),  i_item_id  : line[1], i_rec_start_date: toInteger(line[2]),  i_rec_end_date : toInteger(line[3]), i_item_desc: line[4], i_current_price : toFloat(line[5]),  i_wholesale_cost : toFloat(line[6]), i_brand_id : toInteger(line[7]),  i_brand : line[8],  i_class_id  : toInteger(line[9]), i_class : line[10], i_category_id : toInteger(line[11]),  i_category:  line[12], i_manufact_id  : toInteger(line[13]),  i_manufact : line[14], i_size : line[15], i_formulation :  line[16], i_color:  line[17], i_units:  line[18],
 i_container:  line[19],   i_manager_id :  toInteger(line[20]),  i_product_name :  line[20]});
USING PERIODIC COMMIT LOAD CSV FROM 'file:///home/tpcds/snow/snow_data_5GB/store1.csv' AS line FIELDTERMINATOR '|' CREATE (:store { s_store_sk: toInteger(line[0]),  s_store_id  : line[1], s_rec_start_date : toInteger(line[2]),  s_rec_end_date : toInteger(line[3]), s_store_name : line[4],  s_number_employees  : toInteger(line[5]), s_floor_space : toInteger(line[6]), s_hours : line[7],  s_manager:  line[8], s_market_id  : toInteger(line[9]),  s_geography_class : line[10], s_market_desc  : line[11], s_market_manager :  line[12], s_division_id:  toInteger(line[13]), s_division_name :  line[14], s_company_id :  toInteger(line[15]),   s_company_name  :  line[16],  s_street_number :  line[17],  s_street_name  :  line[18], s_street_type  :  line[19], s_suite_number  :  line[20], s_city : line[21], s_county : line[22], s_state: line[23], s_zip: line[24], s_country : line[25],  s_gmt_offset : toFloat(line[26]),  s_tax_precentage : toFloat(line[27])});
USING PERIODIC COMMIT LOAD CSV FROM 'file:///home/tpcds/snow/snow_data_5GB/promotion1.csv' AS line FIELDTERMINATOR '|' CREATE (:promotion { p_promo_sk: toInteger(line[0]),  p_promo_id  : line[1], p_cost  : toFloat(line[2]), p_response_target  : toInteger(line[3]), p_promo_name : line[4],  p_channel_dmail:  line[5], p_channel_email : line[6],  p_channel_catalog : line[7], p_channel_tv  : line[8], p_channel_radio:  line[9],  p_channel_press:  line[10], p_channel_event :  line[11], p_channel_demo :  line[12],   p_channel_details  :  line[13],  p_purpose :  line[14], p_discount_active:  line[15] });
USING PERIODIC COMMIT LOAD CSV FROM 'file:///home/tpcds/snow/snow_data_5GB/store_sales.csv' AS line FIELDTERMINATOR '|' CREATE (:store_sales {ss_sold_date_sk: toInteger(line[0]),  ss_sold_time_sk  : toInteger(line[1]), ss_item_sk: toInteger(line[2]), ss_customer_sk : toInteger(line[3]), ss_store_sk : toInteger(line[4]),  ss_promo_sk : toInteger(line[5]), ss_ticket_number : toInteger(line[6]), ss_quantity : toInteger(line[7]), ss_wholesale_cost : toFloat(line[8]),  ss_list_price :  toFloat(line[9]), ss_sales_price : toFloat(line[10]), ss_ext_discount_amt : toFloat(line[11]), ss_ext_sales_price : toFloat(line[12]), ss_ext_wholesale_cost :  toFloat(line[13]), ss_ext_list_price:  toFloat(line[14]), ss_ext_tax:  toFloat(line[15]), ss_coupon_amt:  toFloat(line[16]), ss_net_paid:  toFloat(line[17]), ss_net_paid_inc_tax:  toFloat(line[18]), ss_net_profit : toFloat(line[19])});
CREATE CONSTRAINT ON (cd:customer_demographics) ASSERT cd.cd_demo_sk IS UNIQUE;
CREATE CONSTRAINT ON (d:date_dim) ASSERT d.d_date_sk IS UNIQUE;
CREATE CONSTRAINT ON (c:customer) ASSERT c.c_customer_sk IS UNIQUE;
CREATE CONSTRAINT ON (s:store) ASSERT s.s_store_sk IS UNIQUE;
CREATE CONSTRAINT ON (i:item) ASSERT i.i_item_sk IS UNIQUE;
CREATE CONSTRAINT ON (p:promotion) ASSERT p.p_promo_sk IS UNIQUE;
CREATE CONSTRAINT ON (t:time_dim) ASSERT t.t_time_sk IS UNIQUE;
CREATE INDEX ON :store_sales(ss_item_sk, ss_ticket_number);
MATCH (c:customer) WITH c MATCH (ss:store_sales) WHERE c.c_customer_sk=ss.ss_customer_sk CREATE (ss)-[:BY_Customer]->(c);
MATCH (i:item) WITH i MATCH (ss:store_sales) WHERE i.i_item_sk=ss.ss_item_sk CREATE (ss)-[:OF_Item]->(i);
MATCH (p:promotion) WITH p MATCH (ss:store_sales) WHERE p.p_promo_sk=ss.ss_promo_sk CREATE (ss)-[:ON_Promo]->(p);
MATCH (d:date_dim) WITH d MATCH (ss:store_sales) WHERE d.d_date_sk=ss.ss_sold_date_sk CREATE (ss)-[:ON_Date]->(d);
MATCH (t:time_dim) WITH t MATCH (ss:store_sales) WHERE t.t_time_sk=ss.ss_sold_time_sk CREATE (ss)-[:At_Time]->(t);
MATCH (s:store) WITH s MATCH (ss:store_sales) WHERE s.s_store_sk=ss.ss_store_sk CREATE (ss)-[:AT_Store]->(s);
MATCH(d:date_dim) remove d.d_date_sk;
MATCH(t:time_dim) remove t.t_time_sk;
MATCH(i:item) remove i.i_item_sk;
MATCH(s:store)remove s.s_store_sk;
MATCH(p:promotion) remove p.p_promo_sk;
MATCH(c:customer) remove c.c_customer_sk;
MATCH(ss:store_sales) remove ss.ss_sold_date_sk;
MATCH(ss:store_sales) remove ss.ss_sold_time_sk;
MATCH(ss:store_sales) remove ss.ss_item_sk;
MATCH(ss:store_sales) remove ss.ss_customer_sk;
MATCH(ss:store_sales) remove ss.ss_store_sk;
MATCH(ss:store_sales) remove ss.ss_promo_sk ;
