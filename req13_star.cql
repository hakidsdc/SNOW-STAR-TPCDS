MATCH(d:date_dim{d_year:2001})<-[:ON_Date]-(ss:store_sales)
WITH ss MATCH(s:store)<-[:AT_Store]-(ss:store_sales) WITH ss 
MATCH(ss:store_sales)-[:BY_Customer]->(c:customer) WITH ss, c
WHERE ((c.cd_marital_status = 'U' AND c.cd_education_status = 'Advanced Degree' AND ss.ss_sales_price>=100.00 AND ss.ss_sales_price<=150.00 AND c.hd_dep_count = 3) OR (c.cd_marital_status = 'M' AND c.cd_education_status = 'Primary' AND ss.ss_sales_price>=50.00 AND ss.ss_sales_price<=100.00 AND c.hd_dep_count = 1) OR (c.cd_marital_status = 'D' AND c.cd_education_status = 'Secondary' AND ss.ss_sales_price>= 150.00 AND ss.ss_sales_price<=200.00 AND c.hd_dep_count = 1 )) AND ((c.ca_country = 'United States' AND c.ca_state IN ['AZ','NE','IA'] AND ss.ss_net_profit>=100 AND ss.ss_net_profit<=200) OR (c.ca_country = 'United States' AND c.ca_state IN ['MS','CA','NV'] AND ss.ss_net_profit>=150 AND ss.ss_net_profit<=300)  OR (c.ca_country = 'United States' AND c.ca_state IN ['GA','TX','NJ'] AND ss.ss_net_profit>=50 AND ss.ss_net_profit<=250)) RETURN Avg(ss.ss_quantity), Avg(ss.ss_ext_sales_price), Avg(ss.ss_ext_wholesale_cost), Sum(ss.ss_ext_wholesale_cost); 
