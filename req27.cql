MATCH(s:store)<-[:AT_Store]-(ss:store_sales) WHERE s.s_state IN ['TN','TN','TN','TN','TN','TN'] WITH ss, s MATCH(d:date_dim{d_year:2000})<-[:ON_Date]-(ss:store_sales) with ss, s MATCH(cd:customer_demographics{cd_gender:'M', cd_marital_status:'D', cd_education_status:'College'})<-[:Current_CDemo]-(c:customer) with ss, s, c MATCH (ss:store_sales)-[:BY_Customer]->(c:customer) with ss, s MATCH (ss:store_sales)-[:OF_Item]->(i:item) with i, s, ss return i.i_item_id , s.s_state, Avg(ss.ss_quantity) as agg1, Avg(ss.ss_list_price) as agg2, Avg(ss.ss_coupon_amt) as agg3 , avg(ss.ss_sales_price) as agg4  order by i.i_item_id, s.s_state limit 100;
