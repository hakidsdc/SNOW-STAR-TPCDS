MATCH(i:item{i_manager_id:38}) WITH i MATCH(d:date_dim{d_moy:12, d_year:1998}) WITH d, i MATCH(d)<-[:ON_Date]-(ss:store_sales) WITH i, ss MATCH(i)<-[:OF_Item]-(ss) WITH i, ss MATCH(ss)-[:BY_Customer]->(c:customer) WITH i, ss, c MATCH(c)-[:Current_Addr]->(ca:customer_address) WITH ca, i, ss MATCH(ss)-[:AT_Store]->(s:store) WITH s, ca, ss, i where Substring(s.s_zip, 0, 5)<>Substring(ca.ca_zip, 0, 5) RETURN i.i_brand_id as brand_id, i.i_brand as brand, i.i_manufact_id, i.i_manufact, sum(ss.ss_ext_sales_price) as ext_price ORDER  BY ext_price DESC, i.i_brand, i.i_brand_id, i.i_manufact_id, i.i_manufact limit 100;
