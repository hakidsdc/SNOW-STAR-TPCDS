MATCH(d:date_dim{d_year:1998}) WITH d MATCH (d)<-[:ON_Date]-(ss:store_sales) WITH ss MATCH (ss)-[:AT_Store]->(s:store) WITH ss MATCH (ss)-[:BY_Customer]->(c:customer) WITH ss, c WHERE ((c.cd_marital_status= 'M' and c.cd_education_status= '4 yr Degree' and ss.ss_sales_price>=100.00 AND ss.ss_sales_price<=150.00) or (c.cd_marital_status= 'D' and  c.cd_education_status = 'Primary' and ss.ss_sales_price>=50.00 and ss.ss_sales_price<=100.00) or (c.cd_marital_status= 'U' and  c.cd_education_status = 'Advanced Degree' and ss.ss_sales_price>=150.00 and ss.ss_sales_price<=200.00)) and ((c.ca_country = 'United States' and c.ca_state in ['KY', 'GA', 'NM'] and ss.ss_net_profit>=0 and ss.ss_net_profit<=2000) or (c.ca_country = 'United States' and c.ca_state in ['MT', 'OR', 'IN'] and ss.ss_net_profit>=150 and ss.ss_net_profit<=3000) or (c.ca_country = 'United States' and c.ca_state in ['WI', 'MO', 'WV'] and ss.ss_net_profit>=50 and ss.ss_net_profit<=25000 )) return sum(ss.ss_quantity);

